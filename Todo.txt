Todo:
- Duplicate code cleanup: Generic solution for class/struct/record
- UnitTests